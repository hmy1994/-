```mermaid
graph TD
    %% PackML状态模型
    subgraph PackML状态模型
        direction LR
        初始化 --> 待机
        待机 --> 启动中
        启动中 --> 运行中
        运行中 --> 暂停
        运行中 --> 停止中
        运行中 --> 故障
        暂停 --> 运行中
        故障 --> 待机
        停止中 --> 完成
    end

    %% 系统运行流程
    subgraph 系统运行流程
        direction TB
        A[系统上电] --> B[PLC自检]
        B --> C[传感器初始化]
        C --> D[安全状态检查]
        D --> E[设备复位]
        E --> F[进入待机状态]
        F --> G{启动指令?}
        G -- 是 --> H[安全条件验证]
        H --> I[启动皮带1电机]
        I --> J[玻璃检测]
        J --> K{玻璃到位?}
        K -- 是 --> L[机器人抓取玻璃]
        L --> M[移动到皮带2]
        M --> N[放置玻璃]
        N --> O[启动皮带2电机]
        O --> P[玻璃输送完成]
        P --> Q{继续运行?}
        Q -- 是 --> J
        Q -- 否 --> R[停止流程]
        
        %% 故障处理流程
        J --> S{检测到故障?}
        S -- 是 --> T[触发故障状态]
        T --> U[系统安全停止]
        U --> V{故障已排除?}
        V -- 是 --> W[复位故障状态]
        W --> F
        V -- 否 --> X[系统停机]
        
        %% 安全事件处理
        Y[紧急停止触发] --> Z[进入停止中状态]
        AA[安全门锁打开] --> AB[进入暂停状态]
    end

    %% 传感器和执行器
    subgraph 传感器和执行器
        direction TB
        光电传感器1[光电传感器1]
        光电传感器2[光电传感器2]
        位置传感器1[位置传感器1]
        位置传感器2[位置传感器2]
        压力传感器[压力传感器]
        编码器[编码器]
        真空吸盘[真空吸盘]
        电机1[皮带1电机]
        电机2[皮带2电机]
    end

    %% 状态转换触发条件
    subgraph 状态转换触发条件
        direction TB
        启动触发[启动指令+安全条件] --> 启动中
        运行触发[所有条件满足] --> 运行中
        故障触发[传感器异常/安全事件] --> 故障
        停止触发[停止指令/完成] --> 停止中
        复位触发[故障排除] --> 待机
    end

    %% 传感器关联
    光电传感器1 --> J
    位置传感器1 --> K
    压力传感器 --> L
    编码器 --> M
    光电传感器2 --> N
    位置传感器2 --> P
    真空吸盘 --> L
    电机1 --> I
    电机2 --> O

